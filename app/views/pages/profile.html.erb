<% @title = "#{@user.first_name} #{@user.last_name}"  %>
<div class="container-experience-show" style="background: white">
  <div class="row">
    <div class="col-xs-12 col-sm-8">
      <%= cl_image_tag @user.photo, height: 400, width: 400, crop: :fill %>
      <br>
      <br>
      <div class="show-card"><strong>Meet <%= " #{@user.first_name}" %> </strong></div>
      <div><%= @user.description %></div>
    </div>
    <div class="col-xs-12 col-sm-4">
      <div class="host_info_container">
        <div class="row">
          <h1 class="host_name_header"><strong><%= " #{@user.first_name} #{@user.last_name}" %></strong></h1>
          </div>
        </div>
        <br>

          <div class="row"><%= "You are a host." if @user.host %></div>
          <div class="row">
            <% if @user.host %>
              <%= link_to 'Add An Experience To Your Profile', new_experience_path if policy(Experience).create? %>
            <% else %>
              <%= link_to 'Become A Host', edit_user_registration_path %>
            <% end %>
          </div>
        <br>
        <div class="row">
          <div class="host_header">Occupation:</div>
          <div class="host_ans"><%= @user.occupation %>
          </div>
        </div>

        <br>
        <div class="row">
          <div class="host_header">Hometown:</div>
          <div class="host_ans"><%= @user.hometown %>
          </div>
        </div>
        <br>
        <div class="row">
          <div class="host_header">Intersting Fact:</div>
          <div class="host_ans"><%= @user.interesting_fact %>
          </div>
        </div>
        <br>
        <div class="row">
          <div class="host_header">Interests:</div>
          <div class="host_ans"><%=  %></div>
          <!-- interests *could be tags* (need to add in db) -->
        </div>
        <br>
        <div class="row">
          <div class="host_header">Nationality:</div>
          <div class="host_ans"><%= @user.nationality %></div>
        </div>
        <br>
        <div class="row">
          <div class="host_header">Contact Info:</div>
          <div class="host_ans"><%= @user.email %></div>
          <div class="host_ans"><%= @user.phone %></div>
        </div>
      </div>
    </div>
  <div class="row">
    <div class="col-xs-12 col-sm-12">
        <h3 class="form-border"><%= "Your Experiences" %></h3>
        <ul>
          <% @user.experiences.each do |exp| %>
            <li>
              <div><%= link_to exp.name, exp %></div>
              <div><%= exp.description %></div>
              <div><%= "Â¥#{exp.price}" %></div>
              <div><%= exp.capacity %></div>
              <div><%= link_to 'Edit', edit_experience_path(exp) if policy(exp).update? %></div>
              <div><%= link_to 'Delete', exp, method: :delete, data: { confirm: "Are you sure?" } if policy(exp).destroy? %></div>
            </li>
          <% end %>
        </ul>
    </div>
  </div>
  <div class="row">
    <div class="col-xs-12 col-sm-12">
        <h3 class="form-border"><%= "Attending" %></h3>
          <ul>
            <% @attending_bookings.each do |booking| %>
              <li>
                <div><%= link_to booking.experience.name, experience_booking_path(booking.experience, booking) %></div>
                <div><%= "Hosted By #{booking.experience.user.first_name} #{booking.experience.user.last_name}" %></div>
                <div><%= booking.start_time %></div>
                <div><%= booking.end_time %></div>
                <div><%= link_to "Cancel", experience_booking_path(booking.experience, booking), method: :delete, data: { confirm: "Are you sure?"} %></div>
              </li>
            <% end %>
          </ul>
    </div>
  </div>
  <div class="row">
    <div class="col-xs-12 col-sm-12">
      <h3 class="form-border"><%= "Attended" %></h3>
      <ul>
        <% @attended_bookings.each do |booking| %>
          <li>
            <div><%= booking.experience.name %></div>
            <div><%= "Hosted By #{booking.experience.user.first_name} #{booking.experience.user.last_name}" %></div>
            <div><%= booking.start_time %></div>
            <div><%= booking.end_time %></div>
          </li>
        <% end %>
      </ul>
    </div>
  </div>
  <% if @user.host %>
    <div class="row">
      <div class="col-xs-12 col-sm-12">
        <h3 class="form-border"><%= "Hosting" %></h3>
        <ul>
          <% @hosting_bookings.each do |booking| %>
            <li>
              <div><%= booking.experience.name %></div>
              <div><%= "Booked By #{booking.user.first_name} #{booking.user.last_name}" %></div>
              <div><%= booking.start_time %></div>
              <div><%= booking.end_time %></div>
              <div>
                <%= "In Progress" %>
                <%= link_to 'Mark As Complete', edit_experience_booking_path(booking.experience, booking), data: {confirm: 'Are you sure?'} %>
              </div>
              <div><%= link_to "Decline", experience_booking_path(booking.experience, booking), method: :delete, data: { confirm: "Are you sure?"} %></div>
            </li>
          <% end %>
        </ul>
      </div>
    </div>
    <div class="row">
      <div class="col-xs-12 col-sm-12">
        <h3 class="form-border"><%= "Hosted" %></h3>
        <ul>
          <% @hosted_bookings.each do |booking| %>
            <li>
              <div><%= booking.experience.name %></div>
              <div><%= "Booked By #{booking.user.first_name} #{booking.user.last_name}" %></div>
              <div><%= booking.start_time %></div>
              <div><%= booking.end_time %></div>
              <div>
                <%= "This Deal Is Closed" %>
              </div>
            </li>
          <% end %>
        </ul>
      </div>
    </div>
  <% end %>
  </div>
</div>
<% if @user.host %>
  <div class="show-wrapper">
    <div class="show-container">
      <div class="row">
        <div class="col-xs-12 col-sm-12">
          <h2 class="form-border"><%= "Hosting" %></h2>
          <ul>
            <% @hosting_bookings.each do |booking| %>
              <li>
                <div><%= booking.experience.name %></div>
                <div><%= "Booked By #{booking.user.first_name} #{booking.user.last_name}" %></div>
                <div><%= booking.start_time %></div>
                <div><%= booking.end_time %></div>
                <div>
                  <%= "In Progress" %>
                  <%= link_to 'Mark As Complete', edit_experience_booking_path(booking.experience, booking), data: {confirm: 'Are you sure?'} %>
                </div>
                <div><%= link_to "Decline", experience_booking_path(booking.experience, booking), method: :delete, data: { confirm: "Are you sure?"} %></div>
              </li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <div class="show-wrapper">
    <div class="show-container">
      <div class="row">
        <div class="col-xs-12 col-sm-12">
          <h2 class="form-border"><%= "Hosted" %></h2>
          <ul>
            <% @hosted_bookings.each do |booking| %>
              <li>
                <div><%= booking.experience.name %></div>
                <div><%= "Booked By #{booking.user.first_name} #{booking.user.last_name}" %></div>
                <div><%= booking.start_time %></div>
                <div><%= booking.end_time %></div>
                <div>
                  <%= "This Deal Is Closed" %>
                </div>
              </li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
  </div>
<% end %>
